<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>File Protocol Auto-Click Test</title>
    <style>
        body {
            font-family: -apple-system, BlinkMacSystemFont, sans-serif;
            padding: 40px;
            background: #1a1a2e;
            color: white;
            max-width: 800px;
            margin: 0 auto;
        }
        .test-area {
            background: rgba(255,255,255,0.1);
            padding: 30px;
            border-radius: 10px;
            margin: 20px 0;
        }
        .file-link {
            display: block;
            padding: 15px;
            margin: 10px 0;
            background: rgba(66, 133, 244, 0.3);
            border-radius: 5px;
            color: white;
            text-decoration: none;
            border: 1px solid #4285f4;
        }
        .file-link:hover {
            background: rgba(66, 133, 244, 0.5);
        }
        .status {
            background: rgba(0,0,0,0.5);
            padding: 15px;
            border-radius: 5px;
            font-family: 'Monaco', monospace;
            margin: 20px 0;
            height: 300px;
            overflow-y: auto;
        }
        .success { color: #00ff88; }
        .warning { color: #ffaa00; }
        .error { color: #ff4444; }
    </style>
</head>
<body>
    <div class="container">
        <h1>ğŸ“ File Protocol Auto-Click Test</h1>
        
        <div class="test-area">
            <h3>Test File Links</h3>
            <a href="file:///Users/Shared/" class="file-link">ğŸ“‚ file:///Users/Shared/</a>
            <a href="file:///Applications/" class="file-link">ğŸ“‚ file:///Applications/</a>
            <a href="file:///System/Library/CoreServices/" class="file-link">ğŸ“‚ file:///System/Library/CoreServices/</a>
            <a href="file:///Applications/" class="file-link">ğŸŒ file:///Applications/ (Control)</a>
            
            <button onclick="startAutoClicker()">Start Auto-Clicker</button>
            <button onclick="stopAutoClicker()">Stop Auto-Clicker</button>
        </div>

        <div class="status" id="status">
            Status: Testing automated file link clicking...
        </div>
    </div>

    <script>
        const statusElement = document.getElementById('status');
        let autoClickerInterval = null;
        let clickCount = 0;

        function log(message, type = 'info') {
            const entry = document.createElement('div');
            entry.className = type;
            entry.textContent = `[${new Date().toLocaleTimeString()}] ${message}`;
            statusElement.appendChild(entry);
            statusElement.scrollTop = statusElement.scrollHeight;
        }

        function startAutoClicker() {
            if (autoClickerInterval) {
                log('âŒ Auto-clicker already running', 'warning');
                return;
            }

            log('ğŸš€ Starting file link auto-clicker...', 'warning');
            log('âš ï¸ Will attempt to click file:// links every 5 seconds', 'warning');

            autoClickerInterval = setInterval(() => {
                clickCount++;
                log(`ğŸ”„ Auto-click attempt #${clickCount}`, 'info');
                
                // Strategy 1: Click all file:// links
                const fileLinks = document.querySelectorAll('a[href^="file://"]');
                
                if (fileLinks.length > 0) {
                    log(`âœ… Found ${fileLinks.length} file:// links`, 'success');
                    
                    fileLinks.forEach((link, index) => {
                        setTimeout(() => {
                            log(`ğŸ–±ï¸ Clicking: ${link.href}`, 'warning');
                            
                            // Visual feedback
                            const originalBg = link.style.backgroundColor;
                            link.style.backgroundColor = '#34a853';
                            
                            setTimeout(() => {
                                try {
                                    link.click();
                                    log(`âœ… Click dispatched for: ${link.href}`, 'success');
                                } catch (e) {
                                    log(`âŒ Click failed: ${e.message}`, 'error');
                                }
                                link.style.backgroundColor = originalBg;
                            }, 100);
                            
                        }, index * 1000);
                    });
                } else {
                    log('âŒ No file:// links found', 'error');
                }
                
                // Strategy 2: Try to create and click file links dynamically
                if (clickCount % 2 === 0) {
                    try {
                        const dynamicLink = document.createElement('a');
                        dynamicLink.href = 'file:///Users/Shared/';
                        dynamicLink.textContent = 'Dynamic File Link';
                        dynamicLink.style.display = 'none';
                        document.body.appendChild(dynamicLink);
                        
                        log('ğŸ”„ Trying to click dynamically created file link', 'info');
                        dynamicLink.click();
                        document.body.removeChild(dynamicLink);
                        
                    } catch (e) {
                        log(`âŒ Dynamic link click failed: ${e.message}`, 'error');
                    }
                }
                
            }, 5000); // 5 seconds

            log('âœ… Auto-clicker started', 'success');
        }

        function stopAutoClicker() {
            if (autoClickerInterval) {
                clearInterval(autoClickerInterval);
                autoClickerInterval = null;
                log('ğŸ›‘ Auto-clicker stopped', 'success');
            }
        }

        // Monitor link clicks and navigation attempts
        document.addEventListener('click', (e) => {
            if (e.target.tagName === 'A' && e.target.href.startsWith('file://')) {
                log('ğŸ¯ File link click intercepted', 'warning');
                // Browsers will typically block this navigation
            }
        });

        // Listen for beforeunload (would trigger if navigation succeeds)
        window.addEventListener('beforeunload', () => {
            log('ğŸš¨ PAGE NAVIGATION ATTEMPT DETECTED!', 'critical');
        });

        // Test what happens with regular HTTP links (should work)
        setTimeout(() => {
            const httpLink = document.querySelector('a[href="https://google.com"]');
            if (httpLink) {
                log('ğŸ”— Testing regular HTTP link click...', 'info');
                setTimeout(() => {
                    httpLink.click();
                    log('âœ… HTTP link click should work normally', 'success');
                }, 2000);
            }
        }, 3000);

        log('ğŸ”§ Initialized file protocol click tests', 'info');
        log('ğŸ’¡ Browsers typically BLOCK file:// navigation from web pages', 'warning');
        log('ğŸ¯ This is a security feature to protect local files', 'success');
    </script>
</body>
</html>
