<!DOCTYPE html>
<html>
<body>
    <h1>Safari Extension Bridge to Quartz</h1>
    <script>
    function testSafariBridges() {
        console.log('Testing Safari extension bridges to native code...');
        
        // Method 1: Safari App Extension communication
        try {
            // Safari extensions can have native components
            if (window.safari && safari.extension) {
                console.log('Safari extension API available');
                safari.extension.dispatchMessage('injectKeyEvent', {
                    key: 'Enter',
                    keyCode: 13,
                    modifiers: 0
                });
            }
        } catch(e) {}
        
        // Method 2: WebKit internal message handlers
        const internalHandlers = [
            '_CAPI', 'lookup', 'addToReadingList', 'download',
            'openInNewTab', 'openInNewWindow', 'injectEvent'
        ];
        
        internalHandlers.forEach(handler => {
            try {
                if (window.webkit && window.webkit.messageHandlers[handler]) {
                    console.log(`Found handler: ${handler}`);
                    window.webkit.messageHandlers[handler].postMessage({
                        action: 'keyEvent',
                        key: 'Enter',
                        keyCode: 13
                    });
                }
            } catch(e) {}
        });
        
        // Method 3: Try to access Security-Scoped Bookmarks
        try {
            // Safari can grant file system access that might include Quartz
            if (window.showOpenFilePicker) {
                window.showOpenFilePicker().then(handles => {
                    console.log('Got file system access - might bridge to Quartz');
                });
            }
        } catch(e) {}
    }
    
    testSafariBridges();
    </script>
</body>
</html>
